{
    "sourceFile": "app/test.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1768987895163,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1768987904281,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,219 +1,219 @@\n-// working for acceleration & pedometer\r\n+// // working for acceleration & pedometer\r\n \r\n-\"use client\";\r\n-import { useState, useEffect, useRef } from \"react\";\r\n+// \"use client\";\r\n+// import { useState, useEffect, useRef } from \"react\";\r\n \r\n-const ROOM_SIZE_FT = 20;\r\n-const PICKUP_RANGE_FT = 1;\r\n-const STEP_LENGTH = 0.7; // ft per step approx\r\n+// const ROOM_SIZE_FT = 20;\r\n+// const PICKUP_RANGE_FT = 1;\r\n+// const STEP_LENGTH = 0.7; // ft per step approx\r\n \r\n-export default function RealWalkingRoom() {\r\n-  const [playerPosition, setPlayerPosition] = useState({ x: 10, y: 10 });\r\n-  const [boxes, setBoxes] = useState<{ id: number; x: number; y: number; collected: boolean }[]>([]);\r\n-  const [nearestInfo, setNearestInfo] = useState({ distance: 0, angle: 0, id: -1 });\r\n-  const [message, setMessage] = useState(\"\");\r\n-  const [msg,setMsg] = useState(0);\r\n+// export default function RealWalkingRoom() {\r\n+//   const [playerPosition, setPlayerPosition] = useState({ x: 10, y: 10 });\r\n+//   const [boxes, setBoxes] = useState<{ id: number; x: number; y: number; collected: boolean }[]>([]);\r\n+//   const [nearestInfo, setNearestInfo] = useState({ distance: 0, angle: 0, id: -1 });\r\n+//   const [message, setMessage] = useState(\"\");\r\n+//   const [msg,setMsg] = useState(0);\r\n \r\n-  const pos = useRef({ x: 10, y: 10 });\r\n-  const lastAccel = useRef({ x: 0, y: 0, z: 0 });\r\n-  const stepCooldown = useRef(0); // ms\r\n+//   const pos = useRef({ x: 10, y: 10 });\r\n+//   const lastAccel = useRef({ x: 0, y: 0, z: 0 });\r\n+//   const stepCooldown = useRef(0); // ms\r\n \r\n-  // Initialize boxes\r\n-  useEffect(() => {\r\n-    const newBoxes = Array.from({ length: 5 }).map((_, i) => ({\r\n-      id: i,\r\n-      x: Math.random() * (ROOM_SIZE_FT - 4) + 2,\r\n-      y: Math.random() * (ROOM_SIZE_FT - 4) + 2,\r\n-      collected: false,\r\n-    }));\r\n-    setBoxes(newBoxes);\r\n-  }, []);\r\n+//   // Initialize boxes\r\n+//   useEffect(() => {\r\n+//     const newBoxes = Array.from({ length: 5 }).map((_, i) => ({\r\n+//       id: i,\r\n+//       x: Math.random() * (ROOM_SIZE_FT - 4) + 2,\r\n+//       y: Math.random() * (ROOM_SIZE_FT - 4) + 2,\r\n+//       collected: false,\r\n+//     }));\r\n+//     setBoxes(newBoxes);\r\n+//   }, []);\r\n \r\n-  // Update nearest box every 50ms\r\n-  useEffect(() => {\r\n-    const updateNearest = () => {\r\n-      const active = boxes.filter((b) => !b.collected);\r\n-      if (active.length === 0) {\r\n-        setNearestInfo({ distance: 0, angle: 0, id: -1 });\r\n-        return;\r\n-      }\r\n-      let minD = Infinity;\r\n-      let target = active[0];\r\n-      active.forEach((b) => {\r\n-        const dx = pos.current.x - b.x;\r\n-        const dy = pos.current.y - b.y;\r\n-        const d = Math.sqrt(dx * dx + dy * dy);\r\n-        if (d < minD) {\r\n-          minD = d;\r\n-          target = b;\r\n-        }\r\n-      });\r\n-      const angle = Math.atan2(target.y - pos.current.y, target.x - pos.current.x) * (180 / Math.PI);\r\n-      setNearestInfo({ distance: minD, angle, id: target.id });\r\n-    };\r\n-    const id = setInterval(updateNearest, 50);\r\n-    return () => clearInterval(id);\r\n-  }, [boxes]);\r\n+//   // Update nearest box every 50ms\r\n+//   useEffect(() => {\r\n+//     const updateNearest = () => {\r\n+//       const active = boxes.filter((b) => !b.collected);\r\n+//       if (active.length === 0) {\r\n+//         setNearestInfo({ distance: 0, angle: 0, id: -1 });\r\n+//         return;\r\n+//       }\r\n+//       let minD = Infinity;\r\n+//       let target = active[0];\r\n+//       active.forEach((b) => {\r\n+//         const dx = pos.current.x - b.x;\r\n+//         const dy = pos.current.y - b.y;\r\n+//         const d = Math.sqrt(dx * dx + dy * dy);\r\n+//         if (d < minD) {\r\n+//           minD = d;\r\n+//           target = b;\r\n+//         }\r\n+//       });\r\n+//       const angle = Math.atan2(target.y - pos.current.y, target.x - pos.current.x) * (180 / Math.PI);\r\n+//       setNearestInfo({ distance: minD, angle, id: target.id });\r\n+//     };\r\n+//     const id = setInterval(updateNearest, 50);\r\n+//     return () => clearInterval(id);\r\n+//   }, [boxes]);\r\n \r\n- /* ... á€¡á€•á€±á€«á€ºá€€ á€¡á€•á€­á€¯á€„á€ºá€¸á€™á€»á€¬á€¸ á€¡á€á€°á€á€°á€•á€„á€º ... */\r\n+//  /* ... á€¡á€•á€±á€«á€ºá€€ á€¡á€•á€­á€¯á€„á€ºá€¸á€™á€»á€¬á€¸ á€¡á€á€°á€á€°á€•á€„á€º ... */\r\n \r\n-  // Step detection from accelerometer\r\n-  const handleMotion = (event: DeviceMotionEvent) => {\r\n-    // accelerationIncludingGravity á€€ á€–á€¯á€”á€ºá€¸á€…á€±á€¬á€„á€ºá€¸á€á€¬á€€á€­á€¯á€•á€« á€–á€™á€ºá€¸á€™á€­á€á€á€ºá€œá€­á€¯á€· \r\n-    // á€á€€á€šá€·á€º á€›á€½á€±á€·á€œá€»á€¬á€¸á€™á€¾á€¯á€€á€­á€¯á€•á€² á€œá€­á€¯á€á€»á€„á€ºá€›á€„á€º acceleration á€€á€­á€¯ á€žá€¯á€¶á€¸á€á€¬ á€•á€­á€¯á€„á€¼á€­á€™á€ºá€•á€«á€á€šá€º\r\n-    const acc = event.acceleration || event.accelerationIncludingGravity;\r\n-    if (!acc) return;\r\n+//   // Step detection from accelerometer\r\n+//   const handleMotion = (event: DeviceMotionEvent) => {\r\n+//     // accelerationIncludingGravity á€€ á€–á€¯á€”á€ºá€¸á€…á€±á€¬á€„á€ºá€¸á€á€¬á€€á€­á€¯á€•á€« á€–á€™á€ºá€¸á€™á€­á€á€á€ºá€œá€­á€¯á€· \r\n+//     // á€á€€á€šá€·á€º á€›á€½á€±á€·á€œá€»á€¬á€¸á€™á€¾á€¯á€€á€­á€¯á€•á€² á€œá€­á€¯á€á€»á€„á€ºá€›á€„á€º acceleration á€€á€­á€¯ á€žá€¯á€¶á€¸á€á€¬ á€•á€­á€¯á€„á€¼á€­á€™á€ºá€•á€«á€á€šá€º\r\n+//     const acc = event.acceleration || event.accelerationIncludingGravity;\r\n+//     if (!acc) return;\r\n \r\n-    const now = Date.now();\r\n-    if (stepCooldown.current > now) return;\r\n+//     const now = Date.now();\r\n+//     if (stepCooldown.current > now) return;\r\n \r\n-    // Movement magnitude á€á€½á€€á€ºá€á€»á€€á€ºá€á€¼á€„á€ºá€¸\r\n-    const dx = acc.x! - lastAccel.current.x;\r\n-    const dy = acc.y! - lastAccel.current.y;\r\n-    const dz = acc.z! - lastAccel.current.z;\r\n-    const mag = Math.sqrt(dx * dx + dy * dy + dz * dz);\r\n-setMsg(mag);\r\n-    if (mag > 0.4 && mag < 0.6) {// Sensitivity á€€á€­á€¯ á€”á€Šá€ºá€¸á€”á€Šá€ºá€¸ á€‘á€•á€ºá€™á€¼á€¾á€„á€·á€ºá€‘á€¬á€¸á€•á€«á€á€šá€º\r\n-      stepCooldown.current = now + 500; \r\n+//     // Movement magnitude á€á€½á€€á€ºá€á€»á€€á€ºá€á€¼á€„á€ºá€¸\r\n+//     const dx = acc.x! - lastAccel.current.x;\r\n+//     const dy = acc.y! - lastAccel.current.y;\r\n+//     const dz = acc.z! - lastAccel.current.z;\r\n+//     const mag = Math.sqrt(dx * dx + dy * dy + dz * dz);\r\n+// setMsg(mag);\r\n+//     if (mag > 0.4 && mag < 0.6) {// Sensitivity á€€á€­á€¯ á€”á€Šá€ºá€¸á€”á€Šá€ºá€¸ á€‘á€•á€ºá€™á€¼á€¾á€„á€·á€ºá€‘á€¬á€¸á€•á€«á€á€šá€º\r\n+//       stepCooldown.current = now + 500; \r\n       \r\n-      const alpha = deviceOrientation.current; \r\n+//       const alpha = deviceOrientation.current; \r\n       \r\n-      // X = Sin, Y = Cos (North Heading Logic)\r\n-      const moveX = Math.sin(alpha) * STEP_LENGTH;\r\n-      const moveY = Math.cos(alpha) * STEP_LENGTH;\r\n+//       // X = Sin, Y = Cos (North Heading Logic)\r\n+//       const moveX = Math.sin(alpha) * STEP_LENGTH;\r\n+//       const moveY = Math.cos(alpha) * STEP_LENGTH;\r\n \r\n-      pos.current.x += moveX;\r\n-      pos.current.y -= moveY; \r\n+//       pos.current.x += moveX;\r\n+//       pos.current.y -= moveY; \r\n \r\n-      pos.current.x = Math.max(0, Math.min(ROOM_SIZE_FT, pos.current.x));\r\n-      pos.current.y = Math.max(0, Math.min(ROOM_SIZE_FT, pos.current.y));\r\n+//       pos.current.x = Math.max(0, Math.min(ROOM_SIZE_FT, pos.current.x));\r\n+//       pos.current.y = Math.max(0, Math.min(ROOM_SIZE_FT, pos.current.y));\r\n \r\n-      setPlayerPosition({ ...pos.current });\r\n-    }\r\n-    lastAccel.current = { x: acc.x!, y: acc.y!, z: acc.z! };\r\n-  };\r\n+//       setPlayerPosition({ ...pos.current });\r\n+//     }\r\n+//     lastAccel.current = { x: acc.x!, y: acc.y!, z: acc.z! };\r\n+//   };\r\n \r\n \r\n-  useEffect(() => {\r\n-    const handleOrientation = (event: DeviceOrientationEvent) => {\r\n-      let alpha = 0;\r\n-      if ((event as any).webkitCompassHeading) {\r\n-        alpha = (event as any).webkitCompassHeading;\r\n-      } else {\r\n-        alpha = event.alpha || 0;\r\n-        // Android á€™á€¾á€¬ á€¡á€›á€¾á€±á€·á€á€Šá€·á€ºá€á€Šá€·á€ºá€€ 0 á€–á€¼á€…á€ºá€–á€­á€¯á€· á€Šá€¾á€­á€›á€”á€ºá€œá€­á€¯á€¡á€•á€ºá€”á€­á€¯á€„á€ºá€žá€Šá€º\r\n-      }\r\n-      deviceOrientation.current = (alpha * Math.PI) / 180;\r\n-    };\r\n+//   useEffect(() => {\r\n+//     const handleOrientation = (event: DeviceOrientationEvent) => {\r\n+//       let alpha = 0;\r\n+//       if ((event as any).webkitCompassHeading) {\r\n+//         alpha = (event as any).webkitCompassHeading;\r\n+//       } else {\r\n+//         alpha = event.alpha || 0;\r\n+//         // Android á€™á€¾á€¬ á€¡á€›á€¾á€±á€·á€á€Šá€·á€ºá€á€Šá€·á€ºá€€ 0 á€–á€¼á€…á€ºá€–á€­á€¯á€· á€Šá€¾á€­á€›á€”á€ºá€œá€­á€¯á€¡á€•á€ºá€”á€­á€¯á€„á€ºá€žá€Šá€º\r\n+//       }\r\n+//       deviceOrientation.current = (alpha * Math.PI) / 180;\r\n+//     };\r\n     \r\n-    window.addEventListener(\"deviceorientation\", handleOrientation);\r\n-    return () => window.removeEventListener(\"deviceorientation\", handleOrientation);\r\n-  }, []);\r\n+//     window.addEventListener(\"deviceorientation\", handleOrientation);\r\n+//     return () => window.removeEventListener(\"deviceorientation\", handleOrientation);\r\n+//   }, []);\r\n \r\n \r\n-  const handleCollect = (id: number, bx: number, by: number) => {\r\n-    const dx = pos.current.x - bx;\r\n-    const dy = pos.current.y - by;\r\n-    const dist = Math.sqrt(dx * dx + dy * dy);\r\n-    if (dist <= PICKUP_RANGE_FT) {\r\n-      setBoxes((prev) => prev.map((b) => (b.id === id ? { ...b, collected: true } : b)));\r\n-      showMessage(\"Item Collected! ðŸŽ‰\");\r\n-    } else {\r\n-      showMessage(`Too far! Move ${(dist - PICKUP_RANGE_FT).toFixed(1)}ft closer.`);\r\n-    }\r\n-  };\r\n+//   const handleCollect = (id: number, bx: number, by: number) => {\r\n+//     const dx = pos.current.x - bx;\r\n+//     const dy = pos.current.y - by;\r\n+//     const dist = Math.sqrt(dx * dx + dy * dy);\r\n+//     if (dist <= PICKUP_RANGE_FT) {\r\n+//       setBoxes((prev) => prev.map((b) => (b.id === id ? { ...b, collected: true } : b)));\r\n+//       showMessage(\"Item Collected! ðŸŽ‰\");\r\n+//     } else {\r\n+//       showMessage(`Too far! Move ${(dist - PICKUP_RANGE_FT).toFixed(1)}ft closer.`);\r\n+//     }\r\n+//   };\r\n \r\n-  const showMessage = (msg: string) => {\r\n-    setMessage(msg);\r\n-    setTimeout(() => setMessage(\"\"), 2000);\r\n-  };\r\n+//   const showMessage = (msg: string) => {\r\n+//     setMessage(msg);\r\n+//     setTimeout(() => setMessage(\"\"), 2000);\r\n+//   };\r\n \r\n-  // Device orientation for walking direction\r\n-  const deviceOrientation = useRef(0);\r\n+//   // Device orientation for walking direction\r\n+//   const deviceOrientation = useRef(0);\r\n   \r\n \r\n-  // Request permission and start sensors\r\n-  const startTracking = async () => {\r\n-    if ((DeviceMotionEvent as any).requestPermission) {\r\n-      const res = await (DeviceMotionEvent as any).requestPermission();\r\n-      if (res === \"granted\") window.addEventListener(\"devicemotion\", handleMotion);\r\n-    } else {\r\n-      window.addEventListener(\"devicemotion\", handleMotion);\r\n-    }\r\n-  };\r\n+//   // Request permission and start sensors\r\n+//   const startTracking = async () => {\r\n+//     if ((DeviceMotionEvent as any).requestPermission) {\r\n+//       const res = await (DeviceMotionEvent as any).requestPermission();\r\n+//       if (res === \"granted\") window.addEventListener(\"devicemotion\", handleMotion);\r\n+//     } else {\r\n+//       window.addEventListener(\"devicemotion\", handleMotion);\r\n+//     }\r\n+//   };\r\n \r\n-  return (\r\n-    <main className=\"flex flex-col items-center justify-center h-screen bg-slate-950\">\r\n-      <div className=\"text-white text-center mb-4\">\r\n-        <h2 className=\"text-xl font-bold tracking-wider\">REAL WALK ROOM</h2>\r\n-        <div className=\"flex gap-4 justify-center mt-2\">\r\n-          <p>mag - {msg.toFixed(3)}</p>\r\n-          <div className=\"bg-black/40 px-3 py-1 rounded border border-white/10\">\r\n-            <span className=\"text-gray-400 text-xs block\">DISTANCE</span>\r\n-            <span className=\"text-yellow-400 font-mono font-bold\">{nearestInfo.distance.toFixed(1)} ft</span>\r\n-          </div>\r\n-          <div className=\"bg-black/40 px-3 py-1 rounded border border-white/10 flex items-center gap-2\">\r\n-            <span className=\"text-gray-400 text-xs\">DIR</span>\r\n-            <div\r\n-              className=\"w-4 h-4 bg-blue-500 rounded-full flex items-center justify-center text-[10px]\"\r\n-              style={{ transform: `rotate(${nearestInfo.angle}deg)` }}\r\n-            >\r\n-              âž”\r\n-            </div>\r\n-          </div>\r\n-        </div>\r\n-      </div>\r\n+//   return (\r\n+//     <main className=\"flex flex-col items-center justify-center h-screen bg-slate-950\">\r\n+//       <div className=\"text-white text-center mb-4\">\r\n+//         <h2 className=\"text-xl font-bold tracking-wider\">REAL WALK ROOM</h2>\r\n+//         <div className=\"flex gap-4 justify-center mt-2\">\r\n+//           <p>mag - {msg.toFixed(3)}</p>\r\n+//           <div className=\"bg-black/40 px-3 py-1 rounded border border-white/10\">\r\n+//             <span className=\"text-gray-400 text-xs block\">DISTANCE</span>\r\n+//             <span className=\"text-yellow-400 font-mono font-bold\">{nearestInfo.distance.toFixed(1)} ft</span>\r\n+//           </div>\r\n+//           <div className=\"bg-black/40 px-3 py-1 rounded border border-white/10 flex items-center gap-2\">\r\n+//             <span className=\"text-gray-400 text-xs\">DIR</span>\r\n+//             <div\r\n+//               className=\"w-4 h-4 bg-blue-500 rounded-full flex items-center justify-center text-[10px]\"\r\n+//               style={{ transform: `rotate(${nearestInfo.angle}deg)` }}\r\n+//             >\r\n+//               âž”\r\n+//             </div>\r\n+//           </div>\r\n+//         </div>\r\n+//       </div>\r\n \r\n-      <div className=\"relative w-full max-w-[90vh] aspect-square border-2 border-blue-500/30 bg-slate-900 rounded-lg overflow-hidden shadow-[0_0_50px_rgba(0,0,0,0.5)]\">\r\n-        {message && (\r\n-          <div className=\"absolute top-10 left-1/2 -translate-x-1/2 z-50 bg-yellow-400 text-black px-4 py-1 rounded-full font-bold text-sm shadow-lg animate-bounce\">\r\n-            {message}\r\n-          </div>\r\n-        )}\r\n+//       <div className=\"relative w-full max-w-[90vh] aspect-square border-2 border-blue-500/30 bg-slate-900 rounded-lg overflow-hidden shadow-[0_0_50px_rgba(0,0,0,0.5)]\">\r\n+//         {message && (\r\n+//           <div className=\"absolute top-10 left-1/2 -translate-x-1/2 z-50 bg-yellow-400 text-black px-4 py-1 rounded-full font-bold text-sm shadow-lg animate-bounce\">\r\n+//             {message}\r\n+//           </div>\r\n+//         )}\r\n \r\n-        {/* Player */}\r\n-        <div\r\n-          className=\"absolute z-10 pointer-events-none transition-all duration-100\"\r\n-          style={{\r\n-            left: `${(playerPosition.x / ROOM_SIZE_FT) * 100}%`,\r\n-            top: `${(playerPosition.y / ROOM_SIZE_FT) * 100}%`,\r\n-            transform: \"translate(-50%, -50%)\",\r\n-          }}\r\n-        >\r\n-          <div className=\"absolute inset-0 w-[10vh] h-[10vh] border border-blue-400/30 rounded-full -translate-x-1/2 -translate-y-1/2 bg-blue-400/5\" />\r\n-          <div className=\"w-6 h-6 bg-yellow-400 rounded-full shadow-[0_0_20px_#fbbf24] border-2 border-white\" />\r\n-        </div>\r\n+//         {/* Player */}\r\n+//         <div\r\n+//           className=\"absolute z-10 pointer-events-none transition-all duration-100\"\r\n+//           style={{\r\n+//             left: `${(playerPosition.x / ROOM_SIZE_FT) * 100}%`,\r\n+//             top: `${(playerPosition.y / ROOM_SIZE_FT) * 100}%`,\r\n+//             transform: \"translate(-50%, -50%)\",\r\n+//           }}\r\n+//         >\r\n+//           <div className=\"absolute inset-0 w-[10vh] h-[10vh] border border-blue-400/30 rounded-full -translate-x-1/2 -translate-y-1/2 bg-blue-400/5\" />\r\n+//           <div className=\"w-6 h-6 bg-yellow-400 rounded-full shadow-[0_0_20px_#fbbf24] border-2 border-white\" />\r\n+//         </div>\r\n \r\n-        {/* Boxes */}\r\n-        {boxes.map(\r\n-          (box) =>\r\n-            !box.collected && (\r\n-              <button\r\n-                key={box.id}\r\n-                onClick={() => handleCollect(box.id, box.x, box.y)}\r\n-                className={`absolute z-20 text-3xl transition-all duration-300 hover:scale-125 ${\r\n-                  nearestInfo.id === box.id\r\n-                    ? \"opacity-100 drop-shadow-[0_0_10px_rgba(59,130,246,0.8)]\"\r\n-                    : \"opacity-40\"\r\n-                }`}\r\n-                style={{\r\n-                  left: `${(box.x / ROOM_SIZE_FT) * 100}%`,\r\n-                  top: `${(box.y / ROOM_SIZE_FT) * 100}%`,\r\n-                  transform: \"translate(-50%, -50%)\",\r\n-                }}\r\n-              >\r\n-                ðŸ“¦\r\n-              </button>\r\n-            )\r\n-        )}\r\n-      </div>\r\n+//         {/* Boxes */}\r\n+//         {boxes.map(\r\n+//           (box) =>\r\n+//             !box.collected && (\r\n+//               <button\r\n+//                 key={box.id}\r\n+//                 onClick={() => handleCollect(box.id, box.x, box.y)}\r\n+//                 className={`absolute z-20 text-3xl transition-all duration-300 hover:scale-125 ${\r\n+//                   nearestInfo.id === box.id\r\n+//                     ? \"opacity-100 drop-shadow-[0_0_10px_rgba(59,130,246,0.8)]\"\r\n+//                     : \"opacity-40\"\r\n+//                 }`}\r\n+//                 style={{\r\n+//                   left: `${(box.x / ROOM_SIZE_FT) * 100}%`,\r\n+//                   top: `${(box.y / ROOM_SIZE_FT) * 100}%`,\r\n+//                   transform: \"translate(-50%, -50%)\",\r\n+//                 }}\r\n+//               >\r\n+//                 ðŸ“¦\r\n+//               </button>\r\n+//             )\r\n+//         )}\r\n+//       </div>\r\n \r\n-      <button\r\n-        className=\"mt-4 px-6 py-3 bg-blue-600 text-white rounded-full font-bold\"\r\n-        onClick={startTracking}\r\n-      >\r\n-        START WALKING\r\n-      </button>\r\n-    </main>\r\n-  );\r\n-}\r\n+//       <button\r\n+//         className=\"mt-4 px-6 py-3 bg-blue-600 text-white rounded-full font-bold\"\r\n+//         onClick={startTracking}\r\n+//       >\r\n+//         START WALKING\r\n+//       </button>\r\n+//     </main>\r\n+//   );\r\n+// }\r\n"
                }
            ],
            "date": 1768987895163,
            "name": "Commit-0",
            "content": "// working for acceleration & pedometer\r\n\r\n\"use client\";\r\nimport { useState, useEffect, useRef } from \"react\";\r\n\r\nconst ROOM_SIZE_FT = 20;\r\nconst PICKUP_RANGE_FT = 1;\r\nconst STEP_LENGTH = 0.7; // ft per step approx\r\n\r\nexport default function RealWalkingRoom() {\r\n  const [playerPosition, setPlayerPosition] = useState({ x: 10, y: 10 });\r\n  const [boxes, setBoxes] = useState<{ id: number; x: number; y: number; collected: boolean }[]>([]);\r\n  const [nearestInfo, setNearestInfo] = useState({ distance: 0, angle: 0, id: -1 });\r\n  const [message, setMessage] = useState(\"\");\r\n  const [msg,setMsg] = useState(0);\r\n\r\n  const pos = useRef({ x: 10, y: 10 });\r\n  const lastAccel = useRef({ x: 0, y: 0, z: 0 });\r\n  const stepCooldown = useRef(0); // ms\r\n\r\n  // Initialize boxes\r\n  useEffect(() => {\r\n    const newBoxes = Array.from({ length: 5 }).map((_, i) => ({\r\n      id: i,\r\n      x: Math.random() * (ROOM_SIZE_FT - 4) + 2,\r\n      y: Math.random() * (ROOM_SIZE_FT - 4) + 2,\r\n      collected: false,\r\n    }));\r\n    setBoxes(newBoxes);\r\n  }, []);\r\n\r\n  // Update nearest box every 50ms\r\n  useEffect(() => {\r\n    const updateNearest = () => {\r\n      const active = boxes.filter((b) => !b.collected);\r\n      if (active.length === 0) {\r\n        setNearestInfo({ distance: 0, angle: 0, id: -1 });\r\n        return;\r\n      }\r\n      let minD = Infinity;\r\n      let target = active[0];\r\n      active.forEach((b) => {\r\n        const dx = pos.current.x - b.x;\r\n        const dy = pos.current.y - b.y;\r\n        const d = Math.sqrt(dx * dx + dy * dy);\r\n        if (d < minD) {\r\n          minD = d;\r\n          target = b;\r\n        }\r\n      });\r\n      const angle = Math.atan2(target.y - pos.current.y, target.x - pos.current.x) * (180 / Math.PI);\r\n      setNearestInfo({ distance: minD, angle, id: target.id });\r\n    };\r\n    const id = setInterval(updateNearest, 50);\r\n    return () => clearInterval(id);\r\n  }, [boxes]);\r\n\r\n /* ... á€¡á€•á€±á€«á€ºá€€ á€¡á€•á€­á€¯á€„á€ºá€¸á€™á€»á€¬á€¸ á€¡á€á€°á€á€°á€•á€„á€º ... */\r\n\r\n  // Step detection from accelerometer\r\n  const handleMotion = (event: DeviceMotionEvent) => {\r\n    // accelerationIncludingGravity á€€ á€–á€¯á€”á€ºá€¸á€…á€±á€¬á€„á€ºá€¸á€á€¬á€€á€­á€¯á€•á€« á€–á€™á€ºá€¸á€™á€­á€á€á€ºá€œá€­á€¯á€· \r\n    // á€á€€á€šá€·á€º á€›á€½á€±á€·á€œá€»á€¬á€¸á€™á€¾á€¯á€€á€­á€¯á€•á€² á€œá€­á€¯á€á€»á€„á€ºá€›á€„á€º acceleration á€€á€­á€¯ á€žá€¯á€¶á€¸á€á€¬ á€•á€­á€¯á€„á€¼á€­á€™á€ºá€•á€«á€á€šá€º\r\n    const acc = event.acceleration || event.accelerationIncludingGravity;\r\n    if (!acc) return;\r\n\r\n    const now = Date.now();\r\n    if (stepCooldown.current > now) return;\r\n\r\n    // Movement magnitude á€á€½á€€á€ºá€á€»á€€á€ºá€á€¼á€„á€ºá€¸\r\n    const dx = acc.x! - lastAccel.current.x;\r\n    const dy = acc.y! - lastAccel.current.y;\r\n    const dz = acc.z! - lastAccel.current.z;\r\n    const mag = Math.sqrt(dx * dx + dy * dy + dz * dz);\r\nsetMsg(mag);\r\n    if (mag > 0.4 && mag < 0.6) {// Sensitivity á€€á€­á€¯ á€”á€Šá€ºá€¸á€”á€Šá€ºá€¸ á€‘á€•á€ºá€™á€¼á€¾á€„á€·á€ºá€‘á€¬á€¸á€•á€«á€á€šá€º\r\n      stepCooldown.current = now + 500; \r\n      \r\n      const alpha = deviceOrientation.current; \r\n      \r\n      // X = Sin, Y = Cos (North Heading Logic)\r\n      const moveX = Math.sin(alpha) * STEP_LENGTH;\r\n      const moveY = Math.cos(alpha) * STEP_LENGTH;\r\n\r\n      pos.current.x += moveX;\r\n      pos.current.y -= moveY; \r\n\r\n      pos.current.x = Math.max(0, Math.min(ROOM_SIZE_FT, pos.current.x));\r\n      pos.current.y = Math.max(0, Math.min(ROOM_SIZE_FT, pos.current.y));\r\n\r\n      setPlayerPosition({ ...pos.current });\r\n    }\r\n    lastAccel.current = { x: acc.x!, y: acc.y!, z: acc.z! };\r\n  };\r\n\r\n\r\n  useEffect(() => {\r\n    const handleOrientation = (event: DeviceOrientationEvent) => {\r\n      let alpha = 0;\r\n      if ((event as any).webkitCompassHeading) {\r\n        alpha = (event as any).webkitCompassHeading;\r\n      } else {\r\n        alpha = event.alpha || 0;\r\n        // Android á€™á€¾á€¬ á€¡á€›á€¾á€±á€·á€á€Šá€·á€ºá€á€Šá€·á€ºá€€ 0 á€–á€¼á€…á€ºá€–á€­á€¯á€· á€Šá€¾á€­á€›á€”á€ºá€œá€­á€¯á€¡á€•á€ºá€”á€­á€¯á€„á€ºá€žá€Šá€º\r\n      }\r\n      deviceOrientation.current = (alpha * Math.PI) / 180;\r\n    };\r\n    \r\n    window.addEventListener(\"deviceorientation\", handleOrientation);\r\n    return () => window.removeEventListener(\"deviceorientation\", handleOrientation);\r\n  }, []);\r\n\r\n\r\n  const handleCollect = (id: number, bx: number, by: number) => {\r\n    const dx = pos.current.x - bx;\r\n    const dy = pos.current.y - by;\r\n    const dist = Math.sqrt(dx * dx + dy * dy);\r\n    if (dist <= PICKUP_RANGE_FT) {\r\n      setBoxes((prev) => prev.map((b) => (b.id === id ? { ...b, collected: true } : b)));\r\n      showMessage(\"Item Collected! ðŸŽ‰\");\r\n    } else {\r\n      showMessage(`Too far! Move ${(dist - PICKUP_RANGE_FT).toFixed(1)}ft closer.`);\r\n    }\r\n  };\r\n\r\n  const showMessage = (msg: string) => {\r\n    setMessage(msg);\r\n    setTimeout(() => setMessage(\"\"), 2000);\r\n  };\r\n\r\n  // Device orientation for walking direction\r\n  const deviceOrientation = useRef(0);\r\n  \r\n\r\n  // Request permission and start sensors\r\n  const startTracking = async () => {\r\n    if ((DeviceMotionEvent as any).requestPermission) {\r\n      const res = await (DeviceMotionEvent as any).requestPermission();\r\n      if (res === \"granted\") window.addEventListener(\"devicemotion\", handleMotion);\r\n    } else {\r\n      window.addEventListener(\"devicemotion\", handleMotion);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <main className=\"flex flex-col items-center justify-center h-screen bg-slate-950\">\r\n      <div className=\"text-white text-center mb-4\">\r\n        <h2 className=\"text-xl font-bold tracking-wider\">REAL WALK ROOM</h2>\r\n        <div className=\"flex gap-4 justify-center mt-2\">\r\n          <p>mag - {msg.toFixed(3)}</p>\r\n          <div className=\"bg-black/40 px-3 py-1 rounded border border-white/10\">\r\n            <span className=\"text-gray-400 text-xs block\">DISTANCE</span>\r\n            <span className=\"text-yellow-400 font-mono font-bold\">{nearestInfo.distance.toFixed(1)} ft</span>\r\n          </div>\r\n          <div className=\"bg-black/40 px-3 py-1 rounded border border-white/10 flex items-center gap-2\">\r\n            <span className=\"text-gray-400 text-xs\">DIR</span>\r\n            <div\r\n              className=\"w-4 h-4 bg-blue-500 rounded-full flex items-center justify-center text-[10px]\"\r\n              style={{ transform: `rotate(${nearestInfo.angle}deg)` }}\r\n            >\r\n              âž”\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"relative w-full max-w-[90vh] aspect-square border-2 border-blue-500/30 bg-slate-900 rounded-lg overflow-hidden shadow-[0_0_50px_rgba(0,0,0,0.5)]\">\r\n        {message && (\r\n          <div className=\"absolute top-10 left-1/2 -translate-x-1/2 z-50 bg-yellow-400 text-black px-4 py-1 rounded-full font-bold text-sm shadow-lg animate-bounce\">\r\n            {message}\r\n          </div>\r\n        )}\r\n\r\n        {/* Player */}\r\n        <div\r\n          className=\"absolute z-10 pointer-events-none transition-all duration-100\"\r\n          style={{\r\n            left: `${(playerPosition.x / ROOM_SIZE_FT) * 100}%`,\r\n            top: `${(playerPosition.y / ROOM_SIZE_FT) * 100}%`,\r\n            transform: \"translate(-50%, -50%)\",\r\n          }}\r\n        >\r\n          <div className=\"absolute inset-0 w-[10vh] h-[10vh] border border-blue-400/30 rounded-full -translate-x-1/2 -translate-y-1/2 bg-blue-400/5\" />\r\n          <div className=\"w-6 h-6 bg-yellow-400 rounded-full shadow-[0_0_20px_#fbbf24] border-2 border-white\" />\r\n        </div>\r\n\r\n        {/* Boxes */}\r\n        {boxes.map(\r\n          (box) =>\r\n            !box.collected && (\r\n              <button\r\n                key={box.id}\r\n                onClick={() => handleCollect(box.id, box.x, box.y)}\r\n                className={`absolute z-20 text-3xl transition-all duration-300 hover:scale-125 ${\r\n                  nearestInfo.id === box.id\r\n                    ? \"opacity-100 drop-shadow-[0_0_10px_rgba(59,130,246,0.8)]\"\r\n                    : \"opacity-40\"\r\n                }`}\r\n                style={{\r\n                  left: `${(box.x / ROOM_SIZE_FT) * 100}%`,\r\n                  top: `${(box.y / ROOM_SIZE_FT) * 100}%`,\r\n                  transform: \"translate(-50%, -50%)\",\r\n                }}\r\n              >\r\n                ðŸ“¦\r\n              </button>\r\n            )\r\n        )}\r\n      </div>\r\n\r\n      <button\r\n        className=\"mt-4 px-6 py-3 bg-blue-600 text-white rounded-full font-bold\"\r\n        onClick={startTracking}\r\n      >\r\n        START WALKING\r\n      </button>\r\n    </main>\r\n  );\r\n}\r\n"
        }
    ]
}