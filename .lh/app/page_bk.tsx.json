{
    "sourceFile": "app/page_bk.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1768968400146,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1768968400146,
            "name": "Commit-0",
            "content": "\"use client\";\r\nimport { useState, useEffect } from \"react\";\r\nimport dynamic from \"next/dynamic\";\r\n\r\nconst FreeMap = dynamic(() => import(\"../components/FreeMap\"), { ssr: false });\r\n\r\n// 20ft x 20ft area အတွက် scale ညှိထားခြင်း\r\nconst LAT_PER_FOOT = 1 / 364000;\r\nconst LON_PER_FOOT = 1 / (364000 * Math.cos(16.8076918 * Math.PI / 180));\r\nconst AREA_SIZE = 40; // ပေ ၄၀ ပတ်လည် Area အဖြစ် သတ်မှတ်မယ်\r\n\r\n\r\nexport default function Home() {\r\n  const [user, setUser] = useState<{ id: number; username: string } | null>(null);\r\n  const [initialPos, setInitialPos] = useState<[number, number] | null>(null);\r\n  const [gameBoxes, setGameBoxes] = useState<any[]>([]);\r\n\r\n  useEffect(() => {\r\n    const savedUser = localStorage.getItem(\"game_user\");\r\n    setUser(savedUser ? JSON.parse(savedUser) : { id: 1, username: \"Player 1\" });\r\n\r\n    navigator.geolocation.getCurrentPosition(\r\n      (pos) => {\r\n        const lat = pos.coords.latitude;\r\n        const lng = pos.coords.longitude;\r\n        setInitialPos([lat, lng]);\r\n\r\n        // Box များကို Area အတွင်း ကျပန်းချထားခြင်း\r\n        const boxes = [\r\n          { id: 1, type: \"Gold Chest\" },\r\n          { id: 2, type: \"Silver Chest\" },\r\n          { id: 3, type: \"Medicine Pack\" },\r\n          { id: 4, type: \"Treasure Chest\" },\r\n        ].map(box => ({\r\n          ...box,\r\n          lat: lat + (Math.random() * AREA_SIZE - AREA_SIZE/2) * LAT_PER_FOOT,\r\n          lng: lng + (Math.random() * AREA_SIZE - AREA_SIZE/2) * LON_PER_FOOT,\r\n        }));\r\n        setGameBoxes(boxes);\r\n      },\r\n      (err) => alert(\"GPS error! Please allow location access.\"),\r\n      { enableHighAccuracy: true }\r\n    );\r\n  }, []);\r\n\r\n  if (!user || !initialPos) {\r\n    return (\r\n      <div className=\"h-screen flex items-center justify-center text-white bg-slate-900 font-bold\">\r\n        {!user ? \"Verifying Login...\" : \"Searching for GPS...\"}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <main className=\"h-screen w-full overflow-hidden\">\r\n      <FreeMap\r\n        userId={user.id}\r\n        boxes={gameBoxes}\r\n        centerLat={initialPos[0]}\r\n        centerLng={initialPos[1]}\r\n      />\r\n    </main>\r\n  );\r\n}\r\n\r\n// \"use client\";\r\n// import { useState, useEffect } from \"react\";\r\n// import dynamic from \"next/dynamic\";\r\n\r\n// const PhaserGame = dynamic(() => import(\"../components/PhaserGame\"), {\r\n//   ssr: false,\r\n// });\r\n\r\n// export default function Home() {\r\n//   const [initialPos, setInitialPos] = useState<[number, number] | null>(null);\r\n//   const [currentPos, setCurrentPos] = useState<[number, number] | null>(null);\r\n//   const [gameBoxes, setGameBoxes] = useState<any[]>([]);\r\n\r\n//   useEffect(() => {\r\n//     navigator.geolocation.getCurrentPosition((pos) => {\r\n//       const lat = pos.coords.latitude;\r\n//       const lng = pos.coords.longitude;\r\n\r\n//       console.log(\"lat\", lat);\r\n//       console.log(\"lng\", lng);\r\n//       setInitialPos([lat, lng]);\r\n//       setCurrentPos([lat, lng]);\r\n\r\n//       // Player ရဲ့ ပတ်ပတ်လည်မှာ Box ၅ ခု Random ချမယ်\r\n//       const boxes = Array.from({ length: 5 }).map((_, i) => ({\r\n//         id: i,\r\n//         lat: lat + (Math.random() * 0.0002 - 0.0001),\r\n//         lng: lng + (Math.random() * 0.0002 - 0.0001),\r\n//         type: \"Treasure\",\r\n//       }));\r\n//       setGameBoxes(boxes);\r\n//     });\r\n\r\n//     const watchId = navigator.geolocation.watchPosition(\r\n//       (pos) => {\r\n//         // Accuracy 10-15 meter ထက် ပိုဆိုးရင် လက်မခံနဲ့\r\n//         if (pos.coords.accuracy > 10) return;\r\n\r\n//         setCurrentPos([pos.coords.latitude, pos.coords.longitude]);\r\n//       },\r\n//       null,\r\n//       {\r\n//         enableHighAccuracy: true,\r\n//         maximumAge: 0,\r\n//         timeout: 1000, // ၅ စက္ကန့်အတွင်း data မရရင် error ပြခိုင်းမယ်\r\n//       },\r\n//     );\r\n\r\n//     return () => navigator.geolocation.clearWatch(watchId);\r\n//   }, []);\r\n\r\n//   if (!initialPos || !currentPos)\r\n//     return (\r\n//       <div className=\"h-screen bg-black text-white flex items-center justify-center\">\r\n//         GPS Loading...\r\n//       </div>\r\n//     );\r\n\r\n//   return (\r\n//     <main className=\"h-screen w-full bg-black overflow-hidden relative\">\r\n//       <PhaserGame\r\n//         centerLat={initialPos[0]}\r\n//         centerLng={initialPos[1]}\r\n//         currentLat={currentPos[0]}\r\n//         currentLng={currentPos[1]}\r\n//         boxes={gameBoxes}\r\n//       />\r\n\r\n//       <div className=\"absolute top-5 left-5 z-50 text-white bg-black/50 p-2 rounded\">\r\n//         GPS: {currentPos[0].toFixed(5)}, {currentPos[1].toFixed(5)}\r\n//       </div>\r\n//     </main>\r\n//   );\r\n// }\r\n"
        }
    ]
}