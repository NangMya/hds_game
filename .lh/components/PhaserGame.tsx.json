{
    "sourceFile": "components/PhaserGame.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 8,
            "patches": [
                {
                    "date": 1768901842710,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1768902206264,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,50 +2,41 @@\n import { useEffect, useRef } from \"react\";\r\n import * as Phaser from \"phaser\";\r\n import GameScene from \"./GameScene\";\r\n \r\n-interface Props {\r\n-  centerLat: number;\r\n-  centerLng: number;\r\n-  currentLat: number;\r\n-  currentLng: number;\r\n-  boxes: any[];\r\n-}\r\n+export default function PhaserGame({ centerLat, centerLng, currentLat, currentLng, boxes }: any) {\r\n+  const gameRef = useRef<Phaser.Game | null>(null);\r\n \r\n-export default function PhaserGame({ centerLat, centerLng, currentLat, currentLng, boxes }: Props) {\r\n-  const gameRef = useRef<Phaser.Game>(null!);\r\n-  const sceneRef = useRef<GameScene>(null!);\r\n-\r\n   useEffect(() => {\r\n-    // Phaser configuration\r\n     const config: Phaser.Types.Core.GameConfig = {\r\n       type: Phaser.AUTO,\r\n       parent: \"game-container\",\r\n       width: window.innerWidth,\r\n       height: window.innerHeight,\r\n       transparent: true,\r\n-      physics: { default: \"arcade\" },\r\n       scene: [GameScene],\r\n     };\r\n \r\n     const game = new Phaser.Game(config);\r\n     gameRef.current = game;\r\n \r\n-    // Scene စတက်လာရင် Data လှမ်းပို့ပေးမယ်\r\n+    // Game Ready ဖြစ်မှ Scene ကို data နဲ့ စတင်မယ်\r\n     game.events.once(\"ready\", () => {\r\n-      const scene = game.scene.getScene(\"GameScene\") as GameScene;\r\n-      sceneRef.current = scene;\r\n       game.scene.start(\"GameScene\", { centerLat, centerLng, boxes });\r\n     });\r\n \r\n-    return () => game.destroy(true);\r\n-  }, []);\r\n+    return () => {\r\n+      game.destroy(true);\r\n+    };\r\n+  }, []); // [] ဆိုတာ တစ်ကြိမ်ပဲ Run မယ်လို့ ပြောတာပါ\r\n \r\n-  // GPS Update ဖြစ်တိုင်း Phaser ထဲက Function ကို လှမ်းခေါ်မယ်\r\n   useEffect(() => {\r\n-    if (sceneRef.current) {\r\n-      sceneRef.current.updatePlayerPosition(currentLat, currentLng, centerLat, centerLng);\r\n+    if (gameRef.current) {\r\n+      const scene = gameRef.current.scene.getScene(\"GameScene\") as GameScene;\r\n+      if (scene && scene.updatePlayerPosition) {\r\n+        scene.updatePlayerPosition(currentLat, currentLng, centerLat, centerLng);\r\n+      }\r\n     }\r\n   }, [currentLat, currentLng]);\r\n \r\n-  return <div id=\"game-container\" className=\"w-full h-screen\" />;\r\n+  return <div id=\"game-container\" className=\"fixed inset-0\" />;\r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1768903621889,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,41 +2,45 @@\n import { useEffect, useRef } from \"react\";\r\n import * as Phaser from \"phaser\";\r\n import GameScene from \"./GameScene\";\r\n \r\n-export default function PhaserGame({ centerLat, centerLng, currentLat, currentLng, boxes }: any) {\r\n+export default function PhaserGame({ centerLat, centerLng, currentLat, currentLng }: any) {\r\n   const gameRef = useRef<Phaser.Game | null>(null);\r\n \r\n   useEffect(() => {\r\n+    // Game တစ်ခုပဲ ဆောက်တာ သေချာအောင် လုပ်ခြင်း\r\n+    if (gameRef.current) return;\r\n+\r\n     const config: Phaser.Types.Core.GameConfig = {\r\n       type: Phaser.AUTO,\r\n       parent: \"game-container\",\r\n       width: window.innerWidth,\r\n       height: window.innerHeight,\r\n       transparent: true,\r\n+      physics: {\r\n+        default: \"arcade\",\r\n+        arcade: { debug: false } // လမ်းကြောင်းတွေကို မြင်ချင်ရင် true ထားပါ\r\n+      },\r\n       scene: [GameScene],\r\n     };\r\n \r\n     const game = new Phaser.Game(config);\r\n     gameRef.current = game;\r\n \r\n-    // Game Ready ဖြစ်မှ Scene ကို data နဲ့ စတင်မယ်\r\n-    game.events.once(\"ready\", () => {\r\n-      game.scene.start(\"GameScene\", { centerLat, centerLng, boxes });\r\n-    });\r\n-\r\n     return () => {\r\n       game.destroy(true);\r\n+      gameRef.current = null;\r\n     };\r\n-  }, []); // [] ဆိုတာ တစ်ကြိမ်ပဲ Run မယ်လို့ ပြောတာပါ\r\n+  }, []);\r\n \r\n+  // GPS Update တက်လာရင် Phaser ဆီ ပို့ပေးခြင်း\r\n   useEffect(() => {\r\n     if (gameRef.current) {\r\n       const scene = gameRef.current.scene.getScene(\"GameScene\") as GameScene;\r\n-      if (scene && scene.updatePlayerPosition) {\r\n+      if (scene && typeof scene.updatePlayerPosition === 'function') {\r\n         scene.updatePlayerPosition(currentLat, currentLng, centerLat, centerLng);\r\n       }\r\n     }\r\n   }, [currentLat, currentLng]);\r\n \r\n-  return <div id=\"game-container\" className=\"fixed inset-0\" />;\r\n+  return <div id=\"game-container\" className=\"fixed inset-0 w-full h-full\" />;\r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1768964020485,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -33,8 +33,9 @@\n   }, []);\r\n \r\n   // GPS Update တက်လာရင် Phaser ဆီ ပို့ပေးခြင်း\r\n   useEffect(() => {\r\n+    console.log('gameRef',gameRef.current)\r\n     if (gameRef.current) {\r\n       const scene = gameRef.current.scene.getScene(\"GameScene\") as GameScene;\r\n       if (scene && typeof scene.updatePlayerPosition === 'function') {\r\n         scene.updatePlayerPosition(currentLat, currentLng, centerLat, centerLng);\r\n"
                },
                {
                    "date": 1768964034292,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -33,10 +33,10 @@\n   }, []);\r\n \r\n   // GPS Update တက်လာရင် Phaser ဆီ ပို့ပေးခြင်း\r\n   useEffect(() => {\r\n-    console.log('gameRef',gameRef.current)\r\n     if (gameRef.current) {\r\n+      console.log('gameRef',gameRef.current);\r\n       const scene = gameRef.current.scene.getScene(\"GameScene\") as GameScene;\r\n       if (scene && typeof scene.updatePlayerPosition === 'function') {\r\n         scene.updatePlayerPosition(currentLat, currentLng, centerLat, centerLng);\r\n       }\r\n"
                },
                {
                    "date": 1768964046528,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -34,9 +34,9 @@\n \r\n   // GPS Update တက်လာရင် Phaser ဆီ ပို့ပေးခြင်း\r\n   useEffect(() => {\r\n     if (gameRef.current) {\r\n-      console.log('gameRef',gameRef.current);\r\n+      console.log('gameRef',gameRef);\r\n       const scene = gameRef.current.scene.getScene(\"GameScene\") as GameScene;\r\n       if (scene && typeof scene.updatePlayerPosition === 'function') {\r\n         scene.updatePlayerPosition(currentLat, currentLng, centerLat, centerLng);\r\n       }\r\n"
                },
                {
                    "date": 1768964064616,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -33,10 +33,10 @@\n   }, []);\r\n \r\n   // GPS Update တက်လာရင် Phaser ဆီ ပို့ပေးခြင်း\r\n   useEffect(() => {\r\n+    console.log('gameRef',gameRef);\r\n     if (gameRef.current) {\r\n-      console.log('gameRef',gameRef);\r\n       const scene = gameRef.current.scene.getScene(\"GameScene\") as GameScene;\r\n       if (scene && typeof scene.updatePlayerPosition === 'function') {\r\n         scene.updatePlayerPosition(currentLat, currentLng, centerLat, centerLng);\r\n       }\r\n"
                },
                {
                    "date": 1768964083894,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -33,11 +33,11 @@\n   }, []);\r\n \r\n   // GPS Update တက်လာရင် Phaser ဆီ ပို့ပေးခြင်း\r\n   useEffect(() => {\r\n-    console.log('gameRef',gameRef);\r\n     if (gameRef.current) {\r\n       const scene = gameRef.current.scene.getScene(\"GameScene\") as GameScene;\r\n+      console.log('scene',scene);\r\n       if (scene && typeof scene.updatePlayerPosition === 'function') {\r\n         scene.updatePlayerPosition(currentLat, currentLng, centerLat, centerLng);\r\n       }\r\n     }\r\n"
                },
                {
                    "date": 1768964108625,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -35,9 +35,8 @@\n   // GPS Update တက်လာရင် Phaser ဆီ ပို့ပေးခြင်း\r\n   useEffect(() => {\r\n     if (gameRef.current) {\r\n       const scene = gameRef.current.scene.getScene(\"GameScene\") as GameScene;\r\n-      console.log('scene',scene);\r\n       if (scene && typeof scene.updatePlayerPosition === 'function') {\r\n         scene.updatePlayerPosition(currentLat, currentLng, centerLat, centerLng);\r\n       }\r\n     }\r\n"
                }
            ],
            "date": 1768901842710,
            "name": "Commit-0",
            "content": "\"use client\";\r\nimport { useEffect, useRef } from \"react\";\r\nimport * as Phaser from \"phaser\";\r\nimport GameScene from \"./GameScene\";\r\n\r\ninterface Props {\r\n  centerLat: number;\r\n  centerLng: number;\r\n  currentLat: number;\r\n  currentLng: number;\r\n  boxes: any[];\r\n}\r\n\r\nexport default function PhaserGame({ centerLat, centerLng, currentLat, currentLng, boxes }: Props) {\r\n  const gameRef = useRef<Phaser.Game>(null!);\r\n  const sceneRef = useRef<GameScene>(null!);\r\n\r\n  useEffect(() => {\r\n    // Phaser configuration\r\n    const config: Phaser.Types.Core.GameConfig = {\r\n      type: Phaser.AUTO,\r\n      parent: \"game-container\",\r\n      width: window.innerWidth,\r\n      height: window.innerHeight,\r\n      transparent: true,\r\n      physics: { default: \"arcade\" },\r\n      scene: [GameScene],\r\n    };\r\n\r\n    const game = new Phaser.Game(config);\r\n    gameRef.current = game;\r\n\r\n    // Scene စတက်လာရင် Data လှမ်းပို့ပေးမယ်\r\n    game.events.once(\"ready\", () => {\r\n      const scene = game.scene.getScene(\"GameScene\") as GameScene;\r\n      sceneRef.current = scene;\r\n      game.scene.start(\"GameScene\", { centerLat, centerLng, boxes });\r\n    });\r\n\r\n    return () => game.destroy(true);\r\n  }, []);\r\n\r\n  // GPS Update ဖြစ်တိုင်း Phaser ထဲက Function ကို လှမ်းခေါ်မယ်\r\n  useEffect(() => {\r\n    if (sceneRef.current) {\r\n      sceneRef.current.updatePlayerPosition(currentLat, currentLng, centerLat, centerLng);\r\n    }\r\n  }, [currentLat, currentLng]);\r\n\r\n  return <div id=\"game-container\" className=\"w-full h-screen\" />;\r\n}"
        }
    ]
}